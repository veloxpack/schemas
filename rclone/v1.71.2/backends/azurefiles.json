{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.veloxpack.io/rclone/v1.71.2/backends/azurefiles.json",
  "title": "Azure Files",
  "description": "Microsoft Azure Files backend for SMB-compatible cloud file shares",
  "type": "object",
  "properties": {
    "account": {
      "type": "string",
      "title": "Storage Account Name",
      "description": "Azure Storage Account Name. Leave blank to use SAS URL or connection string. Will be read from AZURE_STORAGE_ACCOUNT_NAME env var if env_auth is set",
      "examples": ["mystorageaccount"]
    },
    "share_name": {
      "type": "string",
      "title": "Share Name",
      "description": "Azure Files Share Name (required)",
      "examples": ["myshare", "documents"]
    },
    "env_auth": {
      "type": "boolean",
      "title": "Environment Authentication",
      "description": "Read credentials from runtime (environment variables, CLI or MSI)",
      "default": false
    },
    "key": {
      "type": "string",
      "title": "Storage Account Shared Key",
      "description": "Storage Account Shared Key. Leave blank to use SAS URL or connection string",
      "format": "password"
    },
    "sas_url": {
      "type": "string",
      "title": "SAS URL",
      "description": "SAS URL for authentication. Leave blank if using account/key or connection string",
      "format": "uri",
      "examples": ["https://mystorageaccount.file.core.windows.net/myshare?sv=..."]
    },
    "connection_string": {
      "type": "string",
      "title": "Connection String",
      "description": "Azure Files Connection String",
      "format": "password"
    },
    "tenant": {
      "type": "string",
      "title": "Tenant ID",
      "description": "ID of the service principal's tenant (directory ID). Required for service principal or user authentication",
      "examples": ["00000000-0000-0000-0000-000000000000"]
    },
    "client_id": {
      "type": "string",
      "title": "Client ID",
      "description": "The ID of the client. Required for service principal or user authentication",
      "examples": ["00000000-0000-0000-0000-000000000000"]
    },
    "client_secret": {
      "type": "string",
      "title": "Client Secret",
      "description": "Service principal's client secret",
      "format": "password"
    },
    "client_certificate_path": {
      "type": "string",
      "title": "Client Certificate Path",
      "description": "Path to PEM or PKCS12 certificate file for service principal authentication",
      "examples": ["/path/to/cert.pem", "~/certs/cert.pfx"]
    },
    "client_certificate_password": {
      "type": "string",
      "title": "Client Certificate Password",
      "description": "Password for the certificate file (if encrypted)",
      "format": "password"
    },
    "client_send_certificate_chain": {
      "type": "boolean",
      "title": "Send Certificate Chain",
      "description": "Send certificate chain when using certificate authentication",
      "default": false
    },
    "username": {
      "type": "string",
      "title": "Username",
      "description": "Username for user authentication (with password)",
      "examples": ["user@example.com"]
    },
    "password": {
      "type": "string",
      "title": "Password",
      "description": "Password for user authentication",
      "format": "password"
    },
    "service_principal_file": {
      "type": "string",
      "title": "Service Principal File",
      "description": "Path to file containing service principal credentials",
      "examples": ["/path/to/credentials.json"]
    },
    "use_msi": {
      "type": "boolean",
      "title": "Use MSI",
      "description": "Use Managed Service Identity for authentication",
      "default": false
    },
    "msi_object_id": {
      "type": "string",
      "title": "MSI Object ID",
      "description": "Object ID of the user-assigned MSI. Leave blank if using msi_client_id or msi_mi_res_id",
      "examples": ["00000000-0000-0000-0000-000000000000"]
    },
    "msi_client_id": {
      "type": "string",
      "title": "MSI Client ID",
      "description": "Client ID of the user-assigned MSI. Leave blank if using msi_object_id or msi_mi_res_id",
      "examples": ["00000000-0000-0000-0000-000000000000"]
    },
    "msi_mi_res_id": {
      "type": "string",
      "title": "MSI Resource ID",
      "description": "Azure resource ID of the user-assigned MSI. Leave blank if using msi_client_id or msi_object_id",
      "examples": ["/subscriptions/{subscription}/resourceGroups/{group}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identity}"]
    },
    "disable_instance_discovery": {
      "type": "boolean",
      "title": "Disable Instance Discovery",
      "description": "Skip requesting Microsoft Entra instance metadata. Set true only for disconnected/private clouds like Azure Stack",
      "default": false
    },
    "use_az": {
      "type": "boolean",
      "title": "Use Azure CLI",
      "description": "Use Azure CLI tool (az) for authentication. Don't set env_auth at the same time",
      "default": false
    },
    "endpoint": {
      "type": "string",
      "title": "Endpoint",
      "description": "Endpoint for the service. Leave blank normally",
      "format": "uri",
      "examples": ["https://mystorageaccount.file.core.windows.net/"]
    },
    "chunk_size": {
      "oneOf": [
        { "type": "string", "pattern": "^[0-9]+(\\.[0-9]+)?[BKMGTP]?i?$" },
        { "type": "integer", "minimum": 0 }
      ],
      "title": "Upload Chunk Size",
      "description": "Upload chunk size. Stored in memory, up to --transfers * upload_concurrency chunks at once",
      "default": "4Mi",
      "examples": ["4M", "8M", "16M"]
    },
    "upload_concurrency": {
      "type": "integer",
      "title": "Upload Concurrency",
      "description": "Number of chunks uploaded concurrently for the same file",
      "default": 16,
      "minimum": 1,
      "maximum": 32
    },
    "max_stream_size": {
      "oneOf": [
        { "type": "string", "pattern": "^[0-9]+(\\.[0-9]+)?[BKMGTP]?i?$" },
        { "type": "integer", "minimum": 0 }
      ],
      "title": "Max Stream Size",
      "description": "Max size for streamed files (when size is unknown in advance, e.g., rcat, mount with --vfs-cache-mode off)",
      "default": "10Gi",
      "examples": ["1G", "5G", "10G"]
    },
    "encoding": {
      "type": "string",
      "title": "Encoding",
      "description": "The encoding for the backend (advanced)",
      "default": "Slash,LtGt,DoubleQuote,Colon,Question,Asterisk,Pipe,BackSlash,Ctl,RightPeriod,InvalidUtf8,Dot"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "account": "mystorageaccount",
      "share_name": "myshare",
      "key": "base64-encoded-key=="
    },
    {
      "sas_url": "https://mystorageaccount.file.core.windows.net/myshare?sv=2020-08-04&ss=f&srt=sco&sp=rwdlc&se=..."
    },
    {
      "account": "mystorageaccount",
      "share_name": "myshare",
      "tenant": "00000000-0000-0000-0000-000000000000",
      "client_id": "00000000-0000-0000-0000-000000000000",
      "client_secret": "secret"
    },
    {
      "account": "mystorageaccount",
      "share_name": "myshare",
      "env_auth": true
    }
  ]
}

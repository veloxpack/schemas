{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.veloxpack.io/schemas/core/v1alpha1/profiles/thumbnail/index.json",
  "title": "Thumbnail Profile",
  "description": "ThumbnailProfileSpec defines the desired state of ThumbnailProfile.\nIt configures single or multiple thumbnail extraction from video content,\nsupporting various dimensions, formats, and timing strategies for different\nuse cases like poster frames, preview galleries, and social media sharing.",
  "properties": {
    "globalFilters": {
      "description": "GlobalFilters specifies FFmpeg video filters applied to all thumbnails.\nThese filters are applied before any thumbnail-specific filters.\nUseful for consistent preprocessing across all thumbnails, such as:\n- Color correction: \"eq=brightness=0.1:saturation=1.2\"\n- Deinterlacing: \"yadif\"\n- Logo/watermark removal: \"delogo=x=0:y=0:w=100:h=100\"\n- Aspect ratio: \"setsar=1:1\"\nIndividual thumbnail filters are applied after these global filters.",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "resourceProfileRef": {
      "description": "ResourceProfileRef references a ResourceProfile resource that defines CPU, memory, and GPU requirements\nfor the thumbnail generation operation. This controls the compute resources allocated to thumbnail workers.",
      "allOf": [
        {
          "$ref": "https://schemas.veloxpack.io/schemas/core/mixins/reference.json"
        }
      ]
    },
    "thumbnails": {
      "description": "Thumbnails defines a list of specific thumbnail configurations to generate.\nEach thumbnail can have unique dimensions, format, capture time, and filters.\nUse this for generating distinct thumbnails for different purposes:\n- Poster frame: High resolution at an interesting moment\n- Social media: Square or specific aspect ratios (e.g., 1200x630 for OpenGraph)\n- Gallery: Multiple sizes for responsive image loading\nIf both Thumbnails and TimeOffsets are specified, all combinations are generated.",
      "items": {
        "description": "ThumbnailSpec defines the configuration for a specific thumbnail.\nEach thumbnail can have unique dimensions, format, timing, and filters,\nallowing generation of multiple variants for different use cases\n(e.g., poster frames, social media previews, gallery thumbnails).",
        "properties": {
          "filters": {
            "description": "Filters specifies FFmpeg video filters to apply to this thumbnail.\nFilters are applied in the order specified before image extraction.\nCommon filters: \"scale=1280:720\" (resize), \"crop=w:h:x:y\" (crop region),\n\"eq=brightness=0.1\" (brightness), \"hue=s=0\" (desaturate), \"drawtext=...\" (overlay text).\nThese filters are applied in addition to GlobalFilters.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "format": {
            "default": "jpeg",
            "description": "Format specifies the output image format for this thumbnail.\nOverrides any global format setting for this specific thumbnail.\nChoose based on use case: JPEG for photos, PNG for transparency, WebP for efficiency.",
            "allOf": [
              {
                "$ref": "https://schemas.veloxpack.io/schemas/core/mixins/imageformat.json"
              }
            ]
          },
          "height": {
            "default": 1080,
            "description": "Height specifies the thumbnail height in pixels.\nThe image will be scaled to this height while maintaining aspect ratio\nunless both width and height are specified, which may crop or distort.\nCommon values: 1080 (Full HD), 720 (HD), 360 (SD), 180 (mobile).",
            "minimum": 1,
            "type": "integer"
          },
          "name": {
            "description": "Name identifies this thumbnail configuration (e.g., \"poster\", \"preview\", \"social\", \"og-image\").\nUsed in output filenames and for referencing specific thumbnails.\nShould be unique within the profile for clarity.",
            "type": "string"
          },
          "timeOffset": {
            "description": "TimeOffset specifies when to capture the thumbnail from the video.\nFormat: \"HH:MM:SS\" or \"MM:SS\" or seconds as string (e.g., \"5\", \"30\", \"01:30\", \"00:01:30\").\nIf not specified, defaults to the first frame or a percentage through the video.\nExamples: \"00:00:05\" (5 seconds in), \"00:01:30\" (1 minute 30 seconds), \"30\" (30 seconds).",
            "type": "string"
          },
          "width": {
            "default": 1920,
            "description": "Width specifies the thumbnail width in pixels.\nThe image will be scaled to this width while maintaining aspect ratio\nunless both width and height are specified, which may crop or distort.\nCommon values: 1920 (Full HD), 1280 (HD), 640 (SD), 320 (mobile).",
            "minimum": 1,
            "type": "integer"
          }
        },
        "type": "object",
        "x-kubernetes-validations": [
          {
            "message": "width and height must be positive",
            "rule": "self.width > 0 && self.height > 0"
          }
        ],
        "additionalProperties": false
      },
      "type": "array"
    },
    "timeOffsets": {
      "description": "TimeOffsets specifies a list of time positions for automatic thumbnail generation.\nFormat: \"HH:MM:SS\" or \"MM:SS\" or seconds as string (e.g., \"5\", \"30\", \"01:30\").\nUseful for generating thumbnails at regular intervals or specific key moments.\nAll thumbnails at these offsets will use the same dimensions and format settings\nfrom the first thumbnail spec or defaults.\nExamples: [\"00:00:05\", \"00:00:30\", \"00:01:00\"] generates thumbnails at 5s, 30s, and 1m.",
      "items": {
        "type": "string"
      },
      "type": "array"
    }
  },
  "type": "object"
}
